<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><link rel="icon shortcut" href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml id=favicon-svg><link rel=icon href=/favicon-16x16.png type=image/png sizes=16x16><link rel=icon href=/favicon-32x32.png type=image/png sizes=32x32><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180><link fetchpriority=low href=/site.webmanifest rel=manifest><title>Modernizing an aging PHP stack â€“ Azuka</title><meta name=description content="In April 2009, I was a junior at the now defunct Mountain State University in West Virginia. At the time I made a modest freelance income customizing themes and plugins for some of the common PHP CMSes at the time, especially WordPress.
I took on a project to customize WordPress for a church website: normal CMS functions with a member directory, job scheduling and reminders, a calendar and membersâ€™ listing. It was hard work and severely tested, and perhaps contributed to my ability to find answers to questions. Stack Overflow was very new, so in some cases I was the one answering questions, a lot of which havenâ€™t held up over the years ðŸ˜…."><link rel=canonical href=https://azuka.github.io/posts/post-0008-scaling-legacy-congregate/ itemprop=url><meta property="og:title" content="Modernizing an aging PHP stack"><meta property="og:description" content="
    
      In April 2009, I was a junior at the now
defunct Mountain State University
 
 in West Virginia. At the
time I made a modest freelance income customizing themes and plugins for some of the common PHP CMSes at the time,
especially WordPress.
I took on a project to customize WordPress for a church website: normal CMS functions with a member directory, job
scheduling and reminders, a calendar and members&rsquo; listing. It was hard work and severely tested, and perhaps contributed
to my ability to find answers to questions. Stack Overflow was very new, so in some cases I was the one answering
questions, a lot of which haven&rsquo;t held up over the years &#x1f605;.
    
  "><meta property="og:type" content="
    article
  "><meta property="og:url" content="https://azuka.github.io/posts/post-0008-scaling-legacy-congregate/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-02T22:23:31-07:00"><meta property="article:modified_time" content="2025-11-02T22:23:31-07:00"><meta itemprop=name content="Modernizing an aging PHP stack"><meta itemprop=description content="In April 2009, I was a junior at the now defunct Mountain State University in West Virginia. At the time I made a modest freelance income customizing themes and plugins for some of the common PHP CMSes at the time, especially WordPress.
I took on a project to customize WordPress for a church website: normal CMS functions with a member directory, job scheduling and reminders, a calendar and membersâ€™ listing. It was hard work and severely tested, and perhaps contributed to my ability to find answers to questions. Stack Overflow was very new, so in some cases I was the one answering questions, a lot of which havenâ€™t held up over the years ðŸ˜…."><meta itemprop=datePublished content="2025-11-02T22:23:31-07:00"><meta itemprop=dateModified content="2025-11-02T22:23:31-07:00"><meta itemprop=wordCount content="3433"><meta itemprop=keywords content="Eks,Kubernetes,Php"><meta name=twitter:card content="summary"><meta name=twitter:title content="Modernizing an aging PHP stack"><meta name=twitter:description content="In April 2009, I was a junior at the now defunct Mountain State University in West Virginia. At the time I made a modest freelance income customizing themes and plugins for some of the common PHP CMSes at the time, especially WordPress.
I took on a project to customize WordPress for a church website: normal CMS functions with a member directory, job scheduling and reminders, a calendar and membersâ€™ listing. It was hard work and severely tested, and perhaps contributed to my ability to find answers to questions. Stack Overflow was very new, so in some cases I was the one answering questions, a lot of which havenâ€™t held up over the years ðŸ˜…."><link rel=preload href=/css/compiled/main.min.860421afd86baea436520550e3f5b912c5d0ca8bfec32b073ac5871b3ae0ca74.css as=style integrity="sha256-hgQhr9hrrqQ2UgVQ4/W5EsXQyov+wysHOsWHGzrgynQ="><link href=/css/compiled/main.min.860421afd86baea436520550e3f5b912c5d0ca8bfec32b073ac5871b3ae0ca74.css rel=stylesheet integrity="sha256-hgQhr9hrrqQ2UgVQ4/W5EsXQyov+wysHOsWHGzrgynQ="><link rel=preconnect href=https://www.googletagmanager.com crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-XGCYPWQ1NS"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XGCYPWQ1NS")</script><script>function setTheme(e){document.documentElement.classList.remove("light","dark"),e!=="light"&&e!=="dark"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.classList.add(e),document.documentElement.style.colorScheme=e}setTheme("color-theme"in localStorage?localStorage.getItem("color-theme"):"system")</script><script>localStorage.getItem("banner-closed")&&(document.documentElement.style.setProperty("--hextra-banner-height","0px"),document.documentElement.classList.add("hextra-banner-hidden"))</script></head><body><div class="hextra-nav-container hx:sticky hx:top-0 hx:z-20 hx:w-full hx:bg-transparent hx:print:hidden"><div class="hextra-nav-container-blur hx:pointer-events-none hx:absolute hx:z-[-1] hx:h-full hx:w-full hx:bg-white hx:dark:bg-dark hx:shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] hx:contrast-more:shadow-[0_0_0_1px_#000] hx:dark:shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] hx:contrast-more:dark:shadow-[0_0_0_1px_#fff]"></div><nav class="hextra-max-navbar-width hx:mx-auto hx:flex hx:items-center hx:justify-end hx:gap-2 hx:h-16 hx:px-6"><a class="hx:flex hx:items-center hx:hover:opacity-75 hx:ltr:mr-auto hx:rtl:ml-auto" href=/><span class="hx:mr-2 hx:font-extrabold hx:inline hx:select-none" title=Azuka>Azuka</span>
</a><a title href=/posts/ class="hx:text-sm hx:contrast-more:text-gray-700 hx:contrast-more:dark:text-gray-100 hx:relative hx:-ml-2 hx:hidden hx:whitespace-nowrap hx:p-2 hx:md:inline-flex hx:items-center hx:gap-1 hx:font-medium"><span class=hx:text-center>Posts</span></a><div class="hextra-search-wrapper hx:relative hx:md:w-64"><div class="hx:relative hx:flex hx:items-center hx:text-gray-900 hx:contrast-more:text-gray-800 hx:dark:text-gray-300 hx:contrast-more:dark:text-gray-300"><input placeholder=Search... class="hextra-search-input hx:focus:hextra-focus hx:block hx:w-full hx:appearance-none hx:rounded-lg hx:px-3 hx:py-2 hx:transition-colors hx:text-base hx:leading-tight hx:md:text-sm hx:bg-black/[.05] hx:dark:bg-gray-50/10 hx:focus:bg-white hx:dark:focus:bg-dark hx:placeholder:text-gray-500 hx:dark:placeholder:text-gray-400 hx:contrast-more:border hx:contrast-more:border-current" type=search spellcheck=false>
<kbd class="hx:absolute hx:my-1.5 hx:select-none hx:ltr:right-1.5 hx:rtl:left-1.5 hx:h-5 hx:rounded-sm hx:bg-white hx:px-1.5 hx:font-mono hx:text-[10px] hx:font-medium hx:text-gray-500 hx:border hx:border-gray-200 hx:dark:border-gray-100/20 hx:dark:bg-dark/50 hx:contrast-more:border-current hx:contrast-more:text-current hx:contrast-more:dark:border-current hx:items-center hx:gap-1 hx:transition-opacity hx:pointer-events-none hx:hidden hx:sm:flex">CTRL K</kbd></div><div><ul class="hextra-search-results hextra-scrollbar hx:hidden hx:border hx:border-gray-200 hx:bg-white hx:text-gray-100 hx:dark:border-neutral-800 hx:dark:bg-neutral-900 hx:absolute hx:top-full hx:z-20 hx:mt-2 hx:overflow-auto hx:overscroll-contain hx:rounded-xl hx:py-2.5 hx:shadow-xl hx:max-h-[min(calc(50vh-11rem-env(safe-area-inset-bottom)),400px)] hx:md:max-h-[min(calc(100vh-5rem-env(safe-area-inset-bottom)),400px)] hx:inset-x-0 hx:ltr:md:left-auto hx:rtl:md:right-auto hx:contrast-more:border hx:contrast-more:border-gray-900 hx:contrast-more:dark:border-gray-50 hx:w-screen hx:min-h-[100px] hx:max-w-[min(calc(100vw-2rem),calc(100%+20rem))]" style="transition:max-height .2s ease 0s"></ul></div></div><a class="hx:p-2 hx:text-current" target=_blank rel=noreferrer href=https://github.com/Azuka title=GitHub><svg height="24" fill="currentColor" viewBox="3 3 18 18"><path d="M12 3C7.0275 3 3 7.12937 3 12.2276c0 4.0833 2.57625 7.5321 6.15374 8.7548C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441 9.77249 20.3249 9.76125 19.5982 9.76125 18.8254 7.5 19.2522 6.915 18.2602 6.735 17.7412 6.63375 17.4759 6.19499 16.6569 5.8125 16.4378 5.4975 16.2647 5.0475 15.838 5.80124 15.8264 6.51 15.8149 7.01625 16.4954 7.18499 16.7723 7.99499 18.1679 9.28875 17.7758 9.80625 17.5335 9.885 16.9337 10.1212 16.53 10.38 16.2993 8.3775 16.0687 6.285 15.2728 6.285 11.7432c0-1.0035.34875-1.834.92249-2.47994C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794c0 0 .753749999999999-.24223 2.47499.94583.72001-.20762 1.48501-.31143 2.25001-.31143C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377c1.7212-1.19959 2.475-.94583 2.475-.94583C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326 17.4113 9.9092 17.76 10.7281 17.76 11.7432c0 3.5411-2.1037 4.3255-4.1063 4.5561C13.98 16.5877 14.2613 17.1414 14.2613 18.0065 14.2613 19.2407 14.25 20.2326 14.25 20.5441 14.25 20.7863 14.4188 21.0746 14.8688 20.9824 16.6554 20.364 18.2079 19.1866 19.3078 17.6162c1.0999-1.5705 1.6917-3.4551 1.6922-5.3886C21 7.12937 16.9725 3 12 3z"/></svg>
<span class=hx:sr-only>GitHub</span>
</a><a class="hx:p-2 hx:text-current" target=_blank rel=noreferrer href=https://linkedin.com/in/Azuka title=LinkedIn><svg height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433A2.062 2.062.0 013.274 5.368a2.064 2.064.0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg><span class=hx:sr-only>LinkedIn</span>
</a><a class="hx:p-2 hx:text-current" target=_blank rel=noreferrer href=https://stackoverflow.com/users/66688/zahymaka title="Stack Overflow"><svg height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.1348 2.50733C14.8547 2.03139 14.2379 1.86617 13.7573 2.13828 13.2767 2.4104 13.1143 3.01681 13.3945 3.49274l4.2191 7.16666-5.9127-5.79851c-.394300000000001-.3867-1.0336-.3867-1.4279.0C9.87866 5.24759 9.87866 5.87455 10.273 6.26125l5.9943 5.87865L9.02076 8.03684C8.54016 7.76473 7.92342 7.92995 7.64323 8.40589c-.28019.47593-.11773 1.08234.36287 1.35446l7.4324 4.20825-8.17494-2.1482C6.72941 11.6801 6.1784 11.9982 6.03283 12.5309c-.14556.5328.16946 1.0784.70361 1.2188L15.3001 16H7C6.44772 16 6 16.4477 6 17s.44772 1 1 1H17C17.5523 18 18 17.5523 18 17 18 16.6823 17.8519 16.3993 17.6209 16.2161 17.7958 16.086 17.93 15.8989 17.9917 15.6734 18.0661 15.4009 18.0201 15.125 17.8858 14.9017 18.0828 14.82 18.2557 14.6766 18.3713 14.4802 18.5095 14.2455 18.54 13.9791 18.4779 13.7368 18.6834 13.7061 18.8811 13.6132 19.0393 13.458 19.2258 13.2751 19.3241 13.0385 19.3342 12.7989 19.5443 12.8256 19.7641 12.7875 19.961 12.676 20.4416 12.4039 20.6041 11.7975 20.3239 11.3215L15.1348 2.50733zM4 17C4 16.4477 3.55228 16 3 16S2 16.4477 2 17v1c0 2.2092 1.79086 4 4 4H18c2.2091.0 4-1.7908 4-4V17C22 16.4477 21.5523 16 21 16S20 16.4477 20 17v1C20 19.1046 19.1046 20 18 20H6C4.89543 20 4 19.1046 4 18V17z" fill="#000"/></svg><span class=hx:sr-only>Stack Overflow</span>
</a><button type=button aria-label=Menu class="hextra-hamburger-menu hx:cursor-pointer hx:-mr-2 hx:rounded-sm hx:p-2 hx:active:bg-gray-400/20 hx:md:hidden"><svg height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor"><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8H20"/></g><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16H20"/></g></svg></button></nav></div><div class="hx:mx-auto hx:flex hextra-max-page-width"><aside class="hextra-sidebar-container hx:flex hx:flex-col hx:print:hidden hx:md:top-16 hx:md:shrink-0 hx:md:w-64 hx:md:self-start hx:max-md:[transform:translate3d(0,-100%,0)] hx:md:hidden hx:xl:block"><div class="hx:px-4 hx:pt-4 hx:md:hidden"><div class="hextra-search-wrapper hx:relative hx:md:w-64"><div class="hx:relative hx:flex hx:items-center hx:text-gray-900 hx:contrast-more:text-gray-800 hx:dark:text-gray-300 hx:contrast-more:dark:text-gray-300"><input placeholder=Search... class="hextra-search-input hx:focus:hextra-focus hx:block hx:w-full hx:appearance-none hx:rounded-lg hx:px-3 hx:py-2 hx:transition-colors hx:text-base hx:leading-tight hx:md:text-sm hx:bg-black/[.05] hx:dark:bg-gray-50/10 hx:focus:bg-white hx:dark:focus:bg-dark hx:placeholder:text-gray-500 hx:dark:placeholder:text-gray-400 hx:contrast-more:border hx:contrast-more:border-current" type=search spellcheck=false>
<kbd class="hx:absolute hx:my-1.5 hx:select-none hx:ltr:right-1.5 hx:rtl:left-1.5 hx:h-5 hx:rounded-sm hx:bg-white hx:px-1.5 hx:font-mono hx:text-[10px] hx:font-medium hx:text-gray-500 hx:border hx:border-gray-200 hx:dark:border-gray-100/20 hx:dark:bg-dark/50 hx:contrast-more:border-current hx:contrast-more:text-current hx:contrast-more:dark:border-current hx:items-center hx:gap-1 hx:transition-opacity hx:pointer-events-none hx:hidden hx:sm:flex">CTRL K</kbd></div><div><ul class="hextra-search-results hextra-scrollbar hx:hidden hx:border hx:border-gray-200 hx:bg-white hx:text-gray-100 hx:dark:border-neutral-800 hx:dark:bg-neutral-900 hx:absolute hx:top-full hx:z-20 hx:mt-2 hx:overflow-auto hx:overscroll-contain hx:rounded-xl hx:py-2.5 hx:shadow-xl hx:max-h-[min(calc(50vh-11rem-env(safe-area-inset-bottom)),400px)] hx:md:max-h-[min(calc(100vh-5rem-env(safe-area-inset-bottom)),400px)] hx:inset-x-0 hx:ltr:md:left-auto hx:rtl:md:right-auto hx:contrast-more:border hx:contrast-more:border-gray-900 hx:contrast-more:dark:border-gray-50 hx:w-screen hx:min-h-[100px] hx:max-w-[min(calc(100vw-2rem),calc(100%+20rem))]" style="transition:max-height .2s ease 0s"></ul></div></div></div><div class="hextra-scrollbar hx:overflow-y-auto hx:overflow-x-hidden hx:p-4 hx:grow hx:md:h-[calc(100vh-var(--navbar-height)-var(--menu-height))]"><ul class="hx:flex hx:flex-col hx:gap-1 hx:md:hidden"><li class=open><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/>Posts
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="hx:h-[18px] hx:min-w-[18px] hx:rounded-xs hx:p-0.5 hx:hover:bg-gray-800/5 hx:dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx:origin-center hx:transition-transform hx:rtl:-rotate-180"/></svg></span></a><div class="hx:ltr:pr-0 hx:overflow-hidden"><ul class='hx:relative hx:flex hx:flex-col hx:gap-1 hx:before:absolute hx:before:inset-y-1 hx:before:w-px hx:before:bg-gray-200 hx:before:content-[""] hx:ltr:ml-3 hx:ltr:pl-3 hx:ltr:before:left-0 hx:rtl:mr-3 hx:rtl:pr-3 hx:rtl:before:right-0 hx:dark:before:bg-neutral-800'><li class="hx:flex hx:flex-col open"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hextra-sidebar-active-item hx:bg-primary-100 hx:font-semibold hx:text-primary-800 hx:contrast-more:border hx:contrast-more:border-primary-500 hx:dark:bg-primary-400/10 hx:dark:text-primary-600 hx:contrast-more:dark:border-primary-500" href=/posts/post-0008-scaling-legacy-congregate/>Modernizing an aging PHP stack</a><ul class='hx:flex hx:flex-col hx:gap-1 hx:relative hx:before:absolute hx:before:inset-y-1 hx:before:w-px hx:before:bg-gray-200 hx:before:content-[""] hx:dark:before:bg-neutral-800 hx:ltr:pl-3 hx:ltr:before:left-0 hx:rtl:pr-3 hx:rtl:before:right-0 hx:ltr:ml-3 hx:rtl:mr-3'><li><a href=#preamble class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">Preamble</a></li><li><a href=#so-what-was-the-trigger class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">So what was the trigger?</a></li><li><a href=#solution class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">Solution</a></li><li><a href=#implementation class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">Implementation</a></li><li><a href=#rollout class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">Rollout</a></li><li><a href=#conclusion class="hx:flex hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [word-break:break-word] hx:cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] hx:contrast-more:border hx:gap-2 hx:before:opacity-25 hx:before:content-['#'] hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:text-gray-900 hx:contrast-more:dark:text-gray-50 hx:contrast-more:border-transparent hx:contrast-more:hover:border-gray-900 hx:contrast-more:dark:hover:border-gray-50">Conclusion</a></li></ul></li><li class="hx:flex hx:flex-col"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/post-0005-at-gophercon/>At GopherCon</a></li><li class="hx:flex hx:flex-col"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/post-0004-fun-with-the-ssh-a-flag/>Fun with php deployer and ssh</a></li><li class="hx:flex hx:flex-col"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/post-0003-a-billing-problem/>A billing problem based on assumptions</a></li><li class="hx:flex hx:flex-col"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/post-0002-that-minor-snafu-with-go-types/>That Minor SNAFU With Go Types</a></li><li class="hx:flex hx:flex-col"><a class="hx:flex hx:items-center hx:justify-between hx:gap-2 hx:cursor-pointer hx:rounded-sm hx:px-2 hx:py-1.5 hx:text-sm hx:transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx:text-gray-500 hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:contrast-more:border hx:contrast-more:border-transparent hx:contrast-more:text-gray-900 hx:contrast-more:hover:border-gray-900 hx:dark:text-neutral-400 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:contrast-more:dark:text-gray-50 hx:contrast-more:dark:hover:border-gray-50" href=/posts/post-0001-a-poor-guys-apm/>A Poor Guy's Local PHP Apm</a></li></ul></div></li></ul><div class="hx:max-xl:hidden hx:h-0 hx:w-64 hx:shrink-0"></div></div><div class="hx:md:hidden hx:sticky hx:bottom-0 hx:max-h-(--menu-height) hx:bg-white hx:dark:bg-dark hx:mx-4 hx:py-4 hx:shadow-[0_-12px_16px_#fff] hx:flex hx:items-center hx:gap-2 hx:border-gray-200 hx:dark:border-neutral-800 hx:dark:shadow-[0_-12px_16px_#111] hx:contrast-more:border-neutral-400 hx:contrast-more:shadow-none hx:contrast-more:dark:shadow-none hx:border-t" data-toggle-animation=show><div class="hx:flex hx:grow hx:flex-col"><div class="hx:flex hx:justify-items-start hx:group" data-theme=light><button title="Change theme" data-state=closed data-location=bottom class="hextra-theme-toggle hx:cursor-pointer hx:rounded-md hx:text-left hx:font-medium hx:h-7 hx:px-2 hx:text-xs hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:font-medium hx:text-gray-600 hx:transition-colors hx:dark:text-gray-400 hx:grow" type=button aria-label="Change theme"><div class="hx:flex hx:items-center hx:gap-2 hx:capitalize"><svg height="12" class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden">Light</span><svg height="12" class="hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span class="hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden">Dark</span><svg height="12" class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M11.996094 2C6.4986225 2.0192368 2.03125 6.5024993 2.03125 12c0 5.497501 4.4673725 9.980763 9.964844 10H12 12.0039c5.497471-.01924 9.964844-4.502499 9.964844-10 0-5.4975007-4.467373-9.9807632-9.964844-10H12zM12 4c4.417218.017598 7.96875 3.5822356 7.96875 8 0 4.417764-3.551532 7.982402-7.96875 8z"/></svg>
<span class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden">System</span></div></button><ul class="hextra-theme-toggle-options hx:hidden hx:z-20 hx:max-h-64 hx:overflow-auto hx:rounded-md hx:ring-1 hx:ring-black/5 hx:bg-white hx:py-1 hx:text-sm hx:shadow-lg hx:dark:ring-white/20 hx:dark:bg-neutral-800" style="position:fixed;inset:auto auto 0 0;margin:0;min-width:100px" data-theme=light><li class="hx:flex hx:flex-col"><p data-item=light class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">Light
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li><li class="hx:flex hx:flex-col"><p data-item=dark class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">Dark
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li><li class="hx:flex hx:flex-col"><p data-item=system class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">System
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li></ul></div></div></div></aside><nav class="hextra-toc hx:order-last hx:hidden hx:w-64 hx:shrink-0 hx:xl:block hx:print:hidden hx:px-4" aria-label="table of contents"><div class="hextra-scrollbar hx:sticky hx:top-16 hx:overflow-y-auto hx:pr-4 hx:pt-6 hx:text-sm [hyphens:auto] hx:max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] hx:ltr:-mr-4 hx:rtl:-ml-4"><p class="hx:mb-4 hx:font-semibold hx:tracking-tight">On this page</p><ul><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#preamble>Preamble</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#so-what-was-the-trigger>So what was the trigger?</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#solution>Solution</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#eks-as-the-container-orchestration-platform>EKS as the container orchestration platform</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#cloudflare-as-the-dns-provider>Cloudflare as the DNS provider</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#tenancy-for-laravel-as-the-tenancy-resolver>Tenancy for Laravel as the tenancy resolver</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#grafana-cloud-for-monitoring>Grafana Cloud for monitoring</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#envoy-gateway--aws-nlb-for-load-balancing>Envoy Gateway + AWS NLB for load balancing</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#serversideupphp-for-base-images>serversideup/php for base images</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#implementation>Implementation</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#cloud-readiness-and-feature-parity>Cloud readiness and feature parity</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#implement-multi-tenancy>Implement Multi-tenancy</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#admin-and-dns-management>Admin and DNS Management</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#rollout>Rollout</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#communication>Communication</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#scaling>Scaling</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:ltr:pl-4 hx:rtl:pr-4 hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#monitoring>Monitoring</a></li><li class="hx:my-2 hx:scroll-my-6 hx:scroll-py-6"><a class="hx:font-medium hx:inline-block hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-300 hx:contrast-more:text-gray-900 hx:contrast-more:underline hx:contrast-more:dark:text-gray-50 hx:w-full hx:break-words" href=#conclusion>Conclusion</a></li></ul><div class="hx:mt-8 hx:border-t hx:bg-white hx:pt-8 hx:shadow-[0_-12px_16px_white] hx:dark:bg-dark hx:dark:shadow-[0_-12px_16px_#111] hx:sticky hx:bottom-0 hx:flex hx:flex-col hx:items-start hx:gap-2 hx:pb-8 hx:border-gray-200 hx:dark:border-neutral-800 hx:contrast-more:border-t hx:contrast-more:border-neutral-400 hx:contrast-more:shadow-none hx:contrast-more:dark:border-neutral-400"><button aria-hidden=true id=backToTop onclick=scrollUp() class="hx:cursor-pointer hx:transition-all hx:duration-75 hx:opacity-0 hx:text-xs hx:font-medium hx:text-gray-500 hx:hover:text-gray-900 hx:dark:text-gray-400 hx:dark:hover:text-gray-100 hx:contrast-more:text-gray-800 hx:contrast-more:dark:text-gray-50">
<span>Scroll to top</span>
<svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="hx:inline hx:ltr:ml-1 hx:rtl:mr-1 hx:h-3.5 hx:w-3.5 hx:rounded-full hx:border hx:border-gray-500 hx:hover:border-gray-900 hx:dark:border-gray-400 hx:dark:hover:border-gray-100 hx:contrast-more:border-gray-800 hx:contrast-more:dark:border-gray-50"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"/></svg></button></div></div></nav><article class="hx:w-full hx:break-words hx:flex hx:min-h-[calc(100vh-var(--navbar-height))] hx:min-w-0 hx:justify-center hx:pb-8 hx:pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="hx:w-full hx:min-w-0 hx:max-w-6xl hx:px-6 hx:pt-4 hx:md:px-12"><div class="hx:mt-1.5 hx:flex hx:items-center hx:gap-1 hx:overflow-hidden hx:text-sm hx:text-gray-500 hx:dark:text-gray-400 hx:contrast-more:text-current"><div class="hx:whitespace-nowrap hx:transition-colors hx:min-w-[24px] hx:overflow-hidden hx:text-ellipsis hx:hover:text-gray-900 hx:dark:hover:text-gray-100"><a href=/posts/>Posts</a></div><svg class="hx:w-3.5 hx:shrink-0 hx:rtl:-rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg><div class="hx:whitespace-nowrap hx:transition-colors hx:font-medium hx:text-gray-700 hx:contrast-more:font-bold hx:contrast-more:text-current hx:dark:text-gray-100 hx:contrast-more:dark:text-current">Modernizing an aging PHP stack</div></div><h1 class="hx:mt-2 hx:text-4xl hx:font-bold hx:tracking-tight hx:text-slate-900 hx:dark:text-slate-100">Modernizing an aging PHP stack</h1><div class="hx:mt-4 hx:mb-16 hx:text-gray-500 hx:dark:text-gray-400 hx:text-sm hx:flex hx:items-center hx:flex-wrap hx:gap-y-2"><span class=hx:mr-1>November 2, 2025</span></div><div class=content><p>In April 2009, I was a junior at the now
defunct <a href=https://en.wikipedia.org/wiki/Mountain_State_University target=_blank rel=noopener>Mountain State University<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> in West Virginia. At the
time I made a modest freelance income customizing themes and plugins for some of the common PHP CMSes at the time,
especially WordPress.</p><p>I took on a project to customize WordPress for a church website: normal CMS functions with a member directory, job
scheduling and reminders, a calendar and members&rsquo; listing. It was hard work and severely tested, and perhaps contributed
to my ability to find answers to questions. Stack Overflow was very new, so in some cases I <em>was</em> the one answering
questions, a lot of which haven&rsquo;t held up over the years &#x1f605;.</p><p>Over time, this grew into a product called <a href=https://www.congregateonline.com/ target=_blank rel=noopener>Congregate<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>. It left its WordPress
origins within the first three years and was rewritten into a standalone full CMS using the defunct <a href=https://kohanaframework.org/ target=_blank rel=noopener>Kohana framework<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>. By
2020, mostly through word of mouth, we had over 400 sites hosted. When the pandemic hit, load increased because a lot of
the churches using the system had to deliver a lot of content virtually. Messaging (text, voice, push, email) exploded,
and there were a lot more users accessing the site.</p><p>The aging deployment architecture was starting to show cracks, but the UX was also starting to turn users off. What used
to be modern design in 2012 just wasn&rsquo;t cutting it in 2019. One of my big projects around then was creating an entire
API layer so the application contents could be used in a mobile application, but also to potentially decouple the
presentation layer from the application logic. This would allow people other than me to build entire UIs using modern
technologies while the application layer could evolve separately.</p><h2>Preamble<span class="hx:absolute hx:-mt-20" id=preamble></span>
<a href=#preamble class=subheading-anchor aria-label="Permalink for this section"></a></h2><p>I can use the fancy word <code>multitenant</code> now, but Congregate had its roots in WordPress, which meant every site was
provisioned separately, and pointed to a different database. Over time, we moved from shared hosting to a dedicated VPS,
split out the database server (which eventually moved to Aurora RDS when I hit my limit managing it), and over time had
clients distributed across one of three VPS servers hosted on <a href=https://www.liquidweb.com/ target=_blank rel=noopener>LiquidWeb<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, and
running <a href=https://www.cpanel.net/products/cpanel-whm-features/ target=_blank rel=noopener>CPanel/WHM<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>.</p><p>The servers had to be scaled and provisioned separately depending on usage, and for some of the larger clients, we would move them over to the newest
server (<code>server3</code>) which was provisioned with more vCPUs and RAM. We were tied to CPanel/WHM.</p><p>Provisioning was simply the owner making a new folder, creating a site in WHM/CPanel and pointing to that folder. He
would also make a database copy for the new site. A
<code>config.php</code> file lived in the folder which contained said database name, and the <code>index.php</code> file simply
included a symlinked file that loaded the rest of the application code. A simplified deployment diagram looked like
this:</p><pre class="mermaid hx:mt-6">
  flowchart TD
    subgraph whm1[&#34;WHM/CPanel&#34;]
        app1([&#34;Congregate PHP&#34;])
        dns1([&#34;DNS *.congregateclients.com&#34;])
        cron1[&#34;Cron scheduled process&#34;]
    end
    subgraph server1[&#34;server1&#34;]
        whm1
    end
    subgraph whm2[&#34;WHM/CPanel&#34;]
        app2([&#34;Congregate PHP&#34;])
        dns2([&#34;DNS *.b.congregateclients.com&#34;])
        cron2[&#34;Cron scheduled process&#34;]
    end
    subgraph server2[&#34;server2&#34;]
        whm2
    end
    subgraph whm3[&#34;WHM/CPanel&#34;]
        app3([&#34;Congregate PHP&#34;])
        dns3([&#34;DNS *.c.congregateclients.com&#34;])
    end
    subgraph server3[&#34;server3&#34;]
        whm3
    end
    subgraph liquidweb[&#34;LiquidWeb&#34;]
        server1
        server2
        server3
    end
    subgraph external
        site1[&#34;Site 1&#34;]
        site2[&#34;Site 2&#34;]
        site3[&#34;Site 3&#34;]
    end
    site1 -- served from --&gt; server1
    site2 -- served from --&gt; server2
    site3 -- served from --&gt; server3
</pre><p>I had a pretty good CI/CD configuration using Bitbucket/CircleCI which ran a lot of unit (with PHPUnit) and
acceptance/API (using Codeception) tests. Logs were piped to Loggly (acquired by SolarWinds in 2018), so troubleshooting
was somewhat manageable. I shared this with the owner:</p><blockquote><p>The current application is treated as multiple applications deployed to multiple servers. A few weaknesses of this
approach:</p><ul><li>Every siteâ€™s database has to be set up manually and configured separately using config files.</li><li>Since each site is tied to the server itâ€™s managed on, DNS configuration is difficult, with server1 hosting the name
servers for the congregateclients.com domain, and delegating b.congregateclients.com to server2 and
c.congregateclients.com to server3 respectively</li><li>Due to how the servers were set up (mostly manually), setting up a new server if we need to scale would require
trial and error to ensure they are configured the same way. I have some written notes, but we have made many changes
to tune PHP/Apache and the log setup over the years that would involve a lot of trial and error to get working.</li><li>We are limited by the servers running on Centos 7 which is no longer supported by CPanel (
see <a href=https://support.cpanel.net/hc/en-us/articles/19649329138327-When-will-cPanel-stop-supporting-CentOS-7 target=_blank rel=noopener>https://support.cpanel.net/hc/en-us/articles/19649329138327-When-will-cPanel-stop-supporting-CentOS-7<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>)</li><li>It is difficult to synchronize changes across multiple servers. The deploy process uses a lot of resources, because
we:<ul><li>Deploy the code to each server via ssh/sftp</li><li>Swap out a symlink between the old and new versions of the code</li><li>Build any UI packages (like the theme selector for the admin)</li><li>Run migrations across all sites which potentially causes the server to become unresponsive because we start one
background process PER site</li><li>We currently run into performance issues because every site runs a different php process. php-fpm (used on the demo
site) is very performant, but due to how CPanel/WHM is set up, dedicating one fpm process per site would mean
scaling the servers up to a ridiculous 128GB RAM per server instead of about 12-16GB.</li></ul></li></ul></blockquote><p>In addition to these:</p><ul><li>PHP was locked at version <code>8.3</code>. We could not upgrade the Centos servers so we couldn&rsquo;t take advantage of any
security / performance improvements as well as new features in <code>8.4</code>, with <code>8.5</code> just around the corner.</li></ul><h2>So what was the trigger?<span class="hx:absolute hx:-mt-20" id=so-what-was-the-trigger></span>
<a href=#so-what-was-the-trigger class=subheading-anchor aria-label="Permalink for this section"></a></h2><p>Things came to a head at the beginning of 2025. LLMs had exploded the year before, but 2025 was when AI tools hit
critical mass and the companies behind them began to hungrily scrape data from the Internet.</p><p>We were hit on two fronts: CloudFront daily bills suddenly spiked from less than $4/day to over $200/day, and the VPSes
were experiencing massive load, leading to slow loading sites and outright outages.</p><p>We had AWS WAF deployed in front of the CloudFront CDN, but the basic blocking rules were just not ready for the deluge
of requests. I spent my evenings after work searching for patterns in AWS Athena (from CloudFront logs) and tweaking WAF rules with terraform.
We had to turn on <a href=https://docs.aws.amazon.com/waf/latest/developerguide/waf-bot-control.html target=_blank rel=noopener>bot control<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, block whole
ip ranges and countries, then get creative with counting rules when we inevitably started blocking legitimate access to
large (mostly mp3) files from podcast aggregators and real users, or images from email clients. Luckily, when we reached
out to AWS Support, we were able to get a refund/account credit, with the only requirement being that we turn
on <a href=https://aws.amazon.com/aws-cost-management/aws-cost-anomaly-detection/ target=_blank rel=noopener>AWS Cost Anomaly Detection<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>.</p><p>LiquidWeb, our host had to implement site-wide mod_security rules which caused
an <a href=https://status.liquidweb.com/incidents/15cjwkx21b7s target=_blank rel=noopener>incident<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, and Cloudflare
announced <a href=https://blog.cloudflare.com/introducing-pay-per-crawl/ target=_blank rel=noopener>pay per crawl<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> around the same time. Clearly,
everyone was affected.</p><p>Once we blocked large file access, the crawlers started to target text content and our RDS external data transfer costs
spiked heavily given every page load pulls data from the database. LiquidWeb was able to identify abusive IPs but we
were playing whackamole with these, and there was always a new set when we asked. Clearly, this couldn&rsquo;t go on.</p><p>Eric, the owner of the application asked what could be done on our side, so I sent the diagram below, along with a
proposal:</p><pre class="mermaid hx:mt-6">
  ---
config:
  layout: elk
---
flowchart TD
    lb[&#34;Load Balancer&#34;]
    subgraph aws
        db[(&#34;admin database&#34;)]
    end
    subgraph cloud[&#34;Cloud, e.g. DigitalOcean&#34;]
        cluster
        dns(&#34;DNS Management&#34;)
    end
    subgraph cluster
        node1
        node2
        node3
    end
    subgraph node1[&#34;node1&#34;]
        app1([&#34;Congregate PHP FPM&#34;])
        admin1([&#34;Admin&#34;])
        cron1[&#34;Cron scheduled process&#34;]
    end
    subgraph node2[&#34;node2&#34;]
        app2([&#34;Congregate PHP&#34;])
    end
    subgraph node3[&#34;node3&#34;]
        app3([&#34;Congregate PHP&#34;])
    end
    subgraph external
        site1[&#34;Site 1&#34;]
        site2[&#34;Site 2&#34;]
        site3[&#34;Site 3&#34;]
    end
    site1 -- served from --&gt; lb
    site2 -- served from --&gt; lb
    site3 -- served from --&gt; lb
    lb -- routes to --&gt; app1 &amp; app2 &amp; app3
    app1 &amp; app2 &amp; app3 -- determines and serves client based on domain --&gt; db
    admin1 -- manages client data --&gt; db
    admin1 -- manages dns records --&gt; dns
</pre><blockquote><p>What the new design achieves is:</p><ul><li>We can make the application more performant because we can easily scale up and down to handle peak loads (e.g. on
Sundays)</li><li>We can isolate our infrastructure from public access</li><li>We can have a centralized database where client data lives, which allows us to build an admin panel to manage client
domains, as well as to instantly provision a new site and turn sites on / off. We can also centralize the management
of configuration instead of needing to log into every site as a sysop user, e.g. for configuring modules and
features.</li><li>It becomes easier to monitor the sites as we can centralize logging and error reporting (I have a few providers we
can use where we fall within the free tier, similar to <code>&lt;redacted></code>).</li></ul><p>To build this out, we will need a minimal viable setup that demonstrates:</p><ul><li>An Admin API for client management</li><li>A cloud provider with api support for DNS management and Kubernetes (which weâ€™ll use for deploying the application).</li><li>Weâ€™ll need support for scalable load balancers which we can point the DNS records to.</li><li>A deployment pipeline from GitHub to the setup.</li><li>Weâ€™ll also need to solve the case where we load directory photos from the file system. This is because we use them
in the vcards / pdfs, but we can change how this is done.</li><li>1-2 sites we can configure through the admin api to automatically sync dns to the cloud provider.</li></ul></blockquote><p>Honestly, I wasn&rsquo;t a 100% positive this would work. We had three types of sites hosted on the platform:</p><ol><li>Domain pointed to one of the server ips.</li><li>Domain using one of our vanity nameservers (<code>ns*.congregateclients.com</code>) which resolved to one of the servers.</li><li>One of the above, but with a subdomain pointed to the application on one of the servers. I&rsquo;d built an entire SSO
system for a WordPress plugin (developed by someone else) which allowed churches more flexibility with their site
design while integrating with the Congregate API to fetch data.</li></ol><p>I had the vague idea that I could start on DigitalOcean (for cost reasons), then switch over to AWS when ready, but
luckily after a couple discussions, it made sense to go with AWS all the way, especially when factoring in the cost of
rewriting API calls that weren&rsquo;t a one-to-one mapping between both cloud services. Most of our cloud infrastructure was
already hosted there anyway:</p><ul><li>S3 for file storage</li><li>CloudFront as a CDN</li><li>Aurora RDS as the primary data store</li><li>AWS Transcribe Jobs for sermons audio to speech</li><li>SQS for message queues and background processing</li></ul><h2>Solution<span class="hx:absolute hx:-mt-20" id=solution></span>
<a href=#solution class=subheading-anchor aria-label="Permalink for this section"></a></h2><p>This seemed like a perfect use-case for Kubernetes, specifically AWS EKS. Containerization would resolve all (or most
of) our dependency issues, and I was already familiar with a few open source projects
like <a href=https://cert-manager.io/ target=_blank rel=noopener>cert-manager<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> for dynamic SSL certificate provisioning
and <a href=https://github.com/kubernetes-sigs/external-dns target=_blank rel=noopener>external-dns<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> with AWS Route53 integration. This seemed <em>doable</em>
and I was excited.</p><p>The servers + backup on LiquidWeb were costing somewhere around $170/month per server, and
optimistically, we could get our costs somewhere around $450/month while future-proofing the application and infrastructure.</p><p>This was where we ended up:</p><pre class="mermaid hx:mt-6">
  ---
config:
  layout: elk
  elk:
    mergeEdges: true
    nodePlacementStrategy: LINEAR_SEGMENTS
---
flowchart TD
    subgraph db[&#34;RDS Cluster&#34;]
        sitedbs[(Site Databases)]
        admindb[(Admin Database)]
    end
    subgraph defaultvpc[&#34;Default VPC&#34;]
        db
    end
    subgraph aws
        defaultvpc
        cloudvpc
    end
    subgraph gw[&#34;Envoy Gateway&#34;]
        lb[&#34;Load Balancer Service&#34;]
        gateway[&#34;Global Gateway&#34;]
        tls[&#34;TLS Certs&#34;]
    end
    subgraph nodes
        awsalb[&#34;AWS ALB Controller&#34;]
        cm[&#34;Cert Manager&#34;]
        gw
        app([&#34;App deployment and HPA&#34;])
        svc([&#34;App Service&#34;])
        adminsvc([&#34;Admin Service&#34;])
        admin([&#34;Admin deployment and HPA&#34;])
        cron1[&#34;App CronJob&#34;]
        apphttproutes[&#34;App HTTP Routes&#34;]
        adminhttproutes[&#34;Admin HTTP Routes&#34;]
        awsalb -- provisions --&gt; nlb
        cm -- provisions --&gt; tls
        svc --&gt; app
        adminsvc --&gt; admin
        lb -- routes to --&gt; gateway
    end
    subgraph asg[&#34;Autoscaling Group&#34;]
        nodes
    end
    subgraph cluster[&#34;EKS Cluster&#34;]
        asg
    end
    subgraph cloudflare
        subgraph appdomains[&#34;App Domains&#34;]
            site1[&#34;Site 1&#34;]
            site2[&#34;Site 2&#34;]
            site3[&#34;Site 3&#34;]
        end
        adminsite[&#34;Admin Site&#34;]
    end
    subgraph cloudvpc[&#34;Cloud VPC&#34;]
        cluster
        nlb[&#34;Network Load Balancer&#34;]
    end
    defaultvpc &lt;--- peering --&gt; cloudvpc
    tls -- used by --- apphttproutes &amp; adminhttproutes
    site1 &amp; site2 &amp; site3 &amp; adminsite -- served from --&gt; nlb
    nlb -- routes to --&gt; lb
    gateway -- routes to --&gt; apphttproutes &amp; adminhttproutes
    apphttproutes -- routes to --&gt; svc
    adminhttproutes -- routes to --&gt; adminsvc
    app -- determines and serves client based on domain --&gt; sitedbs
    admin -- manages client data --&gt; admindb
    admin -- manages dns records ----&gt; cloudflare
</pre><p>There were a few moving pieces that would make this possible:</p><h3>EKS as the container orchestration platform<span class="hx:absolute hx:-mt-20" id=eks-as-the-container-orchestration-platform></span>
<a href=#eks-as-the-container-orchestration-platform class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>The <a href=https://github.com/terraform-aws-modules/terraform-aws-eks target=_blank rel=noopener>terraform-aws-modules/terraform-aws-eks<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> terraform
module had almost everything needed to setup a cluster. We used Graviton-based instances (a mix between <code>t4g.xlarge</code> and
<code>r6g.large</code>, thanks <a href=https://instances.vantage.sh/ target=_blank rel=noopener>instances.vantage.sh<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>) and setup
ECR <a href=https://github.com/terraform-aws-modules/terraform-aws-ecr target=_blank rel=noopener>registries<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> for the different applications.</p><p>I had setup kubernetes clusters before on a range of cloud providers, but nothing quite prepared me for
EKS. <a href=https://docs.aws.amazon.com/eks/latest/userguide/access-entries.html target=_blank rel=noopener>Access entries<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, <a href=https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html target=_blank rel=noopener>addon management<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html target=_blank rel=noopener>IAM roles for service accounts<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, <a href=https://github.com/terraform-aws-modules/terraform-aws-iam/tree/master/modules/iam-oidc-provider target=_blank rel=noopener>configuring the IAM OIDC provider for GitHub<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
were just a few things I had to learn about / find. I will eventually go back and properly
implement <a href=https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html target=_blank rel=noopener>pod identity<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, maybe&mldr;</p><p>Throw in a few modules that <em>should</em> have been addons (they frequently are elsewhere) like
the <a href=https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/ target=_blank rel=noopener>AWS Load Balancer Controller<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, <a href=https://secrets-store-csi-driver.sigs.k8s.io/ target=_blank rel=noopener>Secrets Store CSI Driver<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> + <a href=https://github.com/aws/secrets-store-csi-driver-provider-aws target=_blank rel=noopener>AWS Secret Store Provider<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, <a href=https://docs.aws.amazon.com/eks/latest/best-practices/cas.html target=_blank rel=noopener>Cluster Autoscaler<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
and <a href=https://github.com/kubernetes-sigs/descheduler target=_blank rel=noopener>Descheduler<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, and cluster setup cost me a solid weekend and some.</p><p>Shoutout to <a href=https://github.com/cloudposse/terraform-aws-vpc-peering target=_blank rel=noopener>cloudposse/vpc-peering/aws<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> which saved me from a
long session of setting up VPC peering between the new cloud infrastructure and the default VPC where the existing
database lived.</p><p>I did not want to manage or do any work with
a <a href=https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/ target=_blank rel=noopener>CNI plugin<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> yet, so I
just went with the AWS <a href=https://docs.aws.amazon.com/eks/latest/best-practices/vpc-cni.html target=_blank rel=noopener>VPC CNI<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, learning
about <a href=https://docs.aws.amazon.com/eks/latest/userguide/cni-increase-ip-addresses.html target=_blank rel=noopener>prefix delegation<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> along the way
when nodes refused to schedule pods even with available resources.</p><h3>Cloudflare as the DNS provider<span class="hx:absolute hx:-mt-20" id=cloudflare-as-the-dns-provider></span>
<a href=#cloudflare-as-the-dns-provider class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>I was initially going to do some work with Route53 but when I ran the costs for hosted zones, I started to look
elsewhere.</p><p>As far as I knew, there was no official limit for Cloudflare with their free plan, and I&rsquo;d
seen <a href=https://community.cloudflare.com/t/how-many-domains-can-you-have-in-your-free-account/11864/3 target=_blank rel=noopener>numbers in the thousands<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
thrown around, which we weren&rsquo;t in any danger of exceeding: at last count, we were still under 600 sites.</p><p>Considering we&rsquo;d get universal SSL, and a world-class WAF at no cost, along with a well-documented API and SDK clients,
this seemed like a winner.</p><h3>Tenancy for Laravel as the tenancy resolver<span class="hx:absolute hx:-mt-20" id=tenancy-for-laravel-as-the-tenancy-resolver></span>
<a href=#tenancy-for-laravel-as-the-tenancy-resolver class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>I have written multitenancy systems before, and I really did not want to have to write another one for this.</p><p>Luckily, back when I created the API layer, I had created an unholy mash between the newer and more modern Laravel
framework and the original Kohana. Newer route endpoints used Laravel&rsquo;s routing system, but the framework was
initialized after Kohana. It was messy but it worked.</p><p>The <a href=https://tenancyforlaravel.com/ target=_blank rel=noopener>Tenancy for Laravel<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> had almost everything I wanted, and for anything that wasn&rsquo;t
present, the documentation was very clear about how to implement them.</p><h3>Grafana Cloud for monitoring<span class="hx:absolute hx:-mt-20" id=grafana-cloud-for-monitoring></span>
<a href=#grafana-cloud-for-monitoring class=subheading-anchor aria-label="Permalink for this section"></a></h3><p><a href=https://grafana.com/products/cloud/ target=_blank rel=noopener>Grafana Cloud<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> probably has the best free plan you can get from an observability
platform.</p><p>It does get a bit overwhelming though, and what I&rsquo;ve learned should probably go into a separate post. I used
the <a href=https://github.com/grafana/k8s-monitoring-helm target=_blank rel=noopener>k8s-monitoring chart<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> to deploy via Helm,
the <a href=https://grafana.com/docs/grafana-cloud/developer-resources/infrastructure-as-code/terraform/ target=_blank rel=noopener>grafana provider<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> to
set up applications, alerts and synthetics, and the
new <a href=https://registry.terraform.io/providers/grafana/grafana-adaptive-metrics/latest target=_blank rel=noopener>grafana-adaptive-metrics<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> provider
to cut down on metrics ingestion.</p><h3>Envoy Gateway + AWS NLB for load balancing<span class="hx:absolute hx:-mt-20" id=envoy-gateway--aws-nlb-for-load-balancing></span>
<a href=#envoy-gateway--aws-nlb-for-load-balancing class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>The major challenge faced with routing and the DNS setup here was that we needed a static set of IPs for Cloudflare or
whichever DNS provider we would use. As of the writing of this article, the recommendation from AWS is to assign static
IPs to an NLB, with an ALB serving as a target, or to use AWS Global Accelerator.</p><p>We definitely did not (for cost reasons) want to pay for Global Accelerator or for <strong>two</strong> load balancers.</p><p>Additionally, the <a href=https://kubernetes.io/docs/concepts/services-networking/ingress/ target=_blank rel=noopener>Ingress API<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> for Kubernetes has
been frozen, and I was itching to try out the new <a href=https://gateway-api.sigs.k8s.io/ target=_blank rel=noopener>Gateway API<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, eventually
picking <a href=https://gateway.envoyproxy.io/ target=_blank rel=noopener>Envoy Gateway<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> running behind a single NLB.</p><p>We&rsquo;re also running <a href=https://coraza.io/ target=_blank rel=noopener>Coraza<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> via an Envoy Extension Policy as
a <a href=https://github.com/envoyproxy/gateway/issues/671#issuecomment-2419684086 target=_blank rel=noopener>fallback WAF<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>.</p><h3>serversideup/php for base images<span class="hx:absolute hx:-mt-20" id=serversideupphp-for-base-images></span>
<a href=#serversideupphp-for-base-images class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>I think I found <a href=https://serversideup.net/open-source/docker-php/ target=_blank rel=noopener>serversideup/php<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> when I was having trouble building
an image with the php opentelemetry extension. It saved a lot of effort that would have gone into managing the extension
install but also configuring the application server variant (Apache, Nginx+fpm, or Nginx Unit).</p><h2>Implementation<span class="hx:absolute hx:-mt-20" id=implementation></span>
<a href=#implementation class=subheading-anchor aria-label="Permalink for this section"></a></h2><h3>Cloud readiness and feature parity<span class="hx:absolute hx:-mt-20" id=cloud-readiness-and-feature-parity></span>
<a href=#cloud-readiness-and-feature-parity class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>I had a few things to do before even switching the deployment mechanism:</p><ul><li><strong>Unify the database layer</strong>:
I alluded earlier to the unholy mash of two different frameworks. The database in particular was a big one: Laravel
used a PDO connection while the rest of the site used the php mysqli extension. I had to switch this so the database was Laravel-first,
and wrote a custom driver to either use the existing PDO connection or initialize it on demand.</li><li><strong>Remove all local file actions</strong>:
The application was littered with <code>file_exists()</code> checks for the earliest features where files were still stored on
the servers e.g. for directory photos. All local files were synced to S3,
and the database tables for the models had an additional JSON or boolean column to track file existence.</li><li><strong>Unify the cache layer</strong>:
Similar to the database, we had two different cache stores. This was unified, and in the cloud version we set up a
small Elasticache Valkey instance to serve as a distributed cache.</li><li><strong>Create a Laravel entrypoint</strong>:
Instead of loading Laravel after Kohana, I moved all of Kohana&rsquo;s initialization into a service that got loaded for
fallback routes, but also extensively used Laravel&rsquo;s service container to initialize on demand e.g. for logic in the
calendar that hadn&rsquo;t yet been ported over. On the VPS version (because it worked), the application was Kohana
first, then Laravel, while in the cloud version, it was Laravel first, then Kohana.</li></ul><p>All of these required bolstering the Codeception test suite to catch any regressions as well as to cover affected code
paths. We went from about 350 tests to ~680.</p><h3>Implement Multi-tenancy<span class="hx:absolute hx:-mt-20" id=implement-multi-tenancy></span>
<a href=#implement-multi-tenancy class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>A lot of the work here was done by the <a href=https://tenancyforlaravel.com/ target=_blank rel=noopener>Tenancy for Laravel<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> package.
There were a few minor issues that involved tweaking the service container to reset singleton services when switching
between tenants.</p><p>I also wrote a script as part of the regular cron process to self-register all the sites as tenants in the admin
database.</p><p>Every site has a corresponding gateway route pointing to the application service, as well as a TLS configuration to generate
an SSL certificate with Let&rsquo;s Encrypt.</p><h3>Admin and DNS Management<span class="hx:absolute hx:-mt-20" id=admin-and-dns-management></span>
<a href=#admin-and-dns-management class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>The admin interface was a simple Angular application backed by a <a href=https://connectrpc.com/ target=_blank rel=noopener>ConnectRPC<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> API interface.</p><p>The Admin API uses the Cloudflare API to create and delete DNS records, as well as the Kubernetes API to manage <a href=https://gateway-api.sigs.k8s.io/api-types/httproute/ target=_blank rel=noopener>gateway http routes<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
and <a href=https://cert-manager.io/docs/configuration/issuers/ target=_blank rel=noopener>attached certmanager issuers<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>.</p><h2>Rollout<span class="hx:absolute hx:-mt-20" id=rollout></span>
<a href=#rollout class=subheading-anchor aria-label="Permalink for this section"></a></h2><h3>Communication<span class="hx:absolute hx:-mt-20" id=communication></span>
<a href=#communication class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>Eric sent out a few communication messages to site owners with instructions on switching DNS servers. Cloudflare limits
the [number of inactive zones](<a href=https://community.cloudflare.com/t/stuck-on-you-have-exceeded-the-limit-for-adding-zones-please-activate-some-zones/756329] target=_blank rel=noopener>https://community.cloudflare.com/t/stuck-on-you-have-exceeded-the-limit-for-adding-zones-please-activate-some-zones/756329]<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> so
communication had to go out in batches until we hit a critical mass.</p><h3>Scaling<span class="hx:absolute hx:-mt-20" id=scaling></span>
<a href=#scaling class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>We initially started out with the nginx+php-fpm variant of <code>serversideup/php</code>. We scaled up and
benchmarked with <a href=https://k6.io/ target=_blank rel=noopener>k6<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> and <a href=https://www.artillery.io/ target=_blank rel=noopener>Artillery<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> but kept getting high cpu usage. The directory pdf generation had to be moved to a
background process, but we were also able to tune the HPA and resource requests/limits for both the Envoy Gateway pods and the application to handle
the load.</p><p>For the application, we got better performance and resource usage with the <a href=https://unit.nginx.org/ target=_blank rel=noopener>Nginx Unit<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> variant.</p><p>Sadly, Nginx Unit <a href=https://github.com/nginx/unit target=_blank rel=noopener>has been archived<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, and is no longer maintained. I&rsquo;ve heard some good
things about <a href=https://frankenphp.dev/ target=_blank rel=noopener>FrankenPHP<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, which is supported in the
upcoming <a href=https://github.com/serversideup/docker-php/releases/tag/v4.0.0-beta1 target=_blank rel=noopener>v4 version<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> of the php images.</p><h3>Monitoring<span class="hx:absolute hx:-mt-20" id=monitoring></span>
<a href=#monitoring class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>All logs and traces are sent to <a href=https://grafana.com/products/cloud/ target=_blank rel=noopener>Grafana Cloud<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> using the k8s-monitoring chart.
We generate a lot of data, especially metrics and tracing, but I&rsquo;ve been able to tune the sampling rate. Grafana has
also released a few <a href=https://grafana.com/docs/grafana-cloud/adaptive-telemetry/ target=_blank rel=noopener>adaptive telemetry<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> options which help
filter out unwanted data.</p><p>We have Grafana synthetic checks set up to monitor the DNS, latency and ssl certificate expiration for which all the
alerts go to a
dedicated Slack channel.</p><p>We setup a <a href=https://congregate.statuspage.io/ target=_blank rel=noopener>status page<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> to inform customers of incidents and scheduled
maintenance which also tracks some of the downstream services we use.</p><p>Grafana Cloud also has <a href=https://grafana.com/products/cloud/irm/ target=_blank rel=noopener>incident response and management<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a>, as well
as <a href=https://grafana.com/docs/grafana-cloud/alerting-and-irm/slo/ target=_blank rel=noopener>SLO management<svg class="hx:inline hx:rtl:rotate-270 hx:align-baseline" height="1em" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m9.1716 7.7574h7.0711m0 0v7.0711m0-7.0711-8.4853 8.4853" stroke-linecap="round" stroke-linejoin="round"/></svg></a> tools that I hope to explore and use.</p><h2>Conclusion<span class="hx:absolute hx:-mt-20" id=conclusion></span>
<a href=#conclusion class=subheading-anchor aria-label="Permalink for this section"></a></h2><p>This was an exhilarating learning experience, and I&rsquo;m glad I got to do it. I&rsquo;m sure some of this will change, and if
interesting enough, I&rsquo;ll write about them.</p></div><div class=hx:mt-16></div><div class="hx:mb-8 hx:flex hx:items-center hx:border-t hx:pt-8 hx:border-gray-200 hx:dark:border-neutral-800 hx:contrast-more:border-neutral-400 hx:dark:contrast-more:border-neutral-400 hx:print:hidden"><a href=/posts/post-0005-at-gophercon/ title="At GopherCon" class="hx:flex hx:max-w-[50%] hx:items-center hx:gap-1 hx:py-4 hx:text-base hx:font-medium hx:text-gray-600 hx:transition-colors [word-break:break-word] hx:hover:text-primary-600 hx:dark:text-gray-300 hx:md:text-lg hx:ltr:pr-4 hx:rtl:pl-4"><svg class="hx:inline hx:h-5 hx:shrink-0 hx:ltr:rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg>At GopherCon</a></div></main></article></div><footer class="hextra-footer hx:bg-gray-100 hx:pb-[env(safe-area-inset-bottom)] hx:dark:bg-neutral-900 hx:print:bg-transparent"><div class="hx:mx-auto hx:flex hx:gap-2 hx:py-2 hx:px-4 hextra-max-footer-width"><div class="hx:flex hx:justify-items-start hx:group" data-theme=light><button title="Change theme" data-state=closed data-location=bottom class="hextra-theme-toggle hx:cursor-pointer hx:rounded-md hx:text-left hx:font-medium hx:h-7 hx:px-2 hx:text-xs hx:hover:bg-gray-100 hx:hover:text-gray-900 hx:dark:hover:bg-primary-100/5 hx:dark:hover:text-gray-50 hx:font-medium hx:text-gray-600 hx:transition-colors hx:dark:text-gray-400 hx:grow" type=button aria-label="Change theme"><div class="hx:flex hx:items-center hx:gap-2 hx:capitalize"><svg height="12" class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden">Light</span><svg height="12" class="hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span class="hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden">Dark</span><svg height="12" class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M11.996094 2C6.4986225 2.0192368 2.03125 6.5024993 2.03125 12c0 5.497501 4.4673725 9.980763 9.964844 10H12 12.0039c5.497471-.01924 9.964844-4.502499 9.964844-10 0-5.4975007-4.467373-9.9807632-9.964844-10H12zM12 4c4.417218.017598 7.96875 3.5822356 7.96875 8 0 4.417764-3.551532 7.982402-7.96875 8z"/></svg>
<span class="hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden">System</span></div></button><ul class="hextra-theme-toggle-options hx:hidden hx:z-20 hx:max-h-64 hx:overflow-auto hx:rounded-md hx:ring-1 hx:ring-black/5 hx:bg-white hx:py-1 hx:text-sm hx:shadow-lg hx:dark:ring-white/20 hx:dark:bg-neutral-800" style="position:fixed;inset:auto auto 0 0;margin:0;min-width:100px" data-theme=light><li class="hx:flex hx:flex-col"><p data-item=light class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">Light
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=dark]:hidden hx:group-data-[theme=system]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li><li class="hx:flex hx:flex-col"><p data-item=dark class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">Dark
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=light]:hidden hx:group-data-[theme=system]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li><li class="hx:flex hx:flex-col"><p data-item=system class="hx:text-gray-800 hx:dark:text-gray-100 hx:hover:bg-primary-50 hx:hover:text-primary-600 hx:hover:dark:bg-primary-500/10 hx:hover:dark:text-primary-600 hx:relative hx:cursor-pointer hx:whitespace-nowrap hx:py-1.5 hx:transition-colors hx:ltr:pl-3 hx:ltr:pr-9 hx:rtl:pr-3 hx:rtl:pl-9">System
<span class="hx:absolute hx:inset-y-0 hx:flex hx:items-center hx:ltr:right-3 hx:rtl:left-3 hx:group-data-[theme=dark]:hidden hx:group-data-[theme=light]:hidden"><svg height="1em" width="1em" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg></span></p></li></ul></div></div><hr class="hx:border-gray-200 hx:dark:border-neutral-800"><div class="hextra-custom-footer hextra-max-footer-width hx:pl-[max(env(safe-area-inset-left),1.5rem)] hx:pr-[max(env(safe-area-inset-right),1.5rem)] hx:text-gray-600 hx:dark:text-gray-400"></div><div class="hextra-max-footer-width hx:mx-auto hx:flex hx:justify-center hx:py-12 hx:pl-[max(env(safe-area-inset-left),1.5rem)] hx:pr-[max(env(safe-area-inset-right),1.5rem)] hx:text-gray-600 hx:dark:text-gray-400 hx:md:justify-start"><div class="hx:flex hx:w-full hx:flex-col hx:items-center hx:sm:items-start"><div class=hx:font-semibold><a class="hx:flex hx:text-sm hx:items-center hx:gap-1 hx:text-current" target=_blank rel="noopener noreferrer" title="Hextra GitHub Homepage" href=https://github.com/imfing/hextra><span>Powered by Hextra<svg height="1em" class="hx:inline-block hx:ltr:ml-1 hx:rtl:mr-1 hx:align-[-2.5px]" viewBox="0 0 180 180" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="m105.50024 22.224647c-9.59169-5.537563-21.40871-5.537563-31.000093.0L39.054693 42.689119C29.463353 48.226675 23.55484 58.460531 23.55484 69.535642v40.928918c0 11.07542 5.908513 21.3092 15.499853 26.84652l35.445453 20.46446c9.591313 5.53732 21.408404 5.53732 31.000094.0l35.44507-20.46446c9.59131-5.53732 15.49985-15.7711 15.49985-26.84652V69.535642c0-11.075111-5.90854-21.308967-15.49985-26.846523zM34.112797 85.737639c-1.384445 2.397827-1.384445 5.352099.0 7.749927l24.781554 42.922974c1.38437 2.39783 3.942853 3.87496 6.711592 3.87496h49.563107c2.76905.0 5.3273-1.47713 6.71144-3.87496l24.78194-42.922974c1.38414-2.397828 1.38414-5.3521.0-7.749927L121.88049 42.814746c-1.38414-2.397828-3.94239-3.874964-6.71144-3.874964H65.605944c-2.768739.0-5.327223 1.477059-6.711592 3.874964z" style="stroke-width:.774993"/></svg></span></a></div></div></div></footer><script defer src=/js/main.min.cb7a23a5df1c111bc4480bf230e34602359a7a80de78a8cc15c369903ecd80fa.js integrity="sha256-y3ojpd8cERvESAvyMONGAjWaeoDeeKjMFcNpkD7NgPo="></script><script defer src=/js/flexsearch.433e941a8a573ebb9931fc16fc75266ab6b93f569ac2fb4f3dc66882e0416f4c.js integrity="sha256-Qz6UGopXPruZMfwW/HUmara5P1aawvtPPcZoguBBb0w=" crossorigin=anonymous></script><script defer src=/en.search.min.097e3a24da0aba2ac82ef0f53e82e1500343a7126260a0203f3a45bbe0876093.js integrity="sha256-CX46JNoKuirILvD1PoLhUANDpxJiYKAgPzpFu+CHYJM="></script><script defer src=/js/mermaid.min.198b19442f86f0b46a17e56d3abf744c3a28a3427e66fa8dada3b589a77babcc.js integrity="sha256-GYsZRC+G8LRqF+VtOr90TDooo0J+ZvqNraO1iad7q8w=" crossorigin=anonymous></script><script type=module>
    import elkLayouts from 'https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@latest/dist/mermaid-layout-elk.esm.min.mjs';
    mermaid.registerLayoutLoaders(elkLayouts);
    console.log({elkLayouts});
</script><script>document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".mermaid").forEach(e=>{e.dataset.original=e.innerHTML});const t=document.documentElement.classList.contains("dark")?"dark":"default";mermaid.initialize({startOnLoad:!0,theme:t}),mermaid.registerIconPacks([{name:"logos",loader:()=>fetch("https://unpkg.com/@iconify-json/logos@1/icons.json").then(e=>e.json())},{name:"carbon",loader:()=>fetch("https://unpkg.com/@iconify-json/carbon@1/icons.json").then(e=>e.json())}]);let e;new MutationObserver(()=>{clearTimeout(e),e=setTimeout(()=>{const e=document.documentElement.classList.contains("dark")?"dark":"default";document.querySelectorAll(".mermaid").forEach(e=>{e.innerHTML=e.dataset.original,e.removeAttribute("data-processed")}),mermaid.initialize({startOnLoad:!0,theme:e}),mermaid.init()},150)}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})})</script></body></html>